



<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#FFF">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">

<link rel="icon" type="image/ico" sizes="32x32" href="/images/favicon.ico">
  <meta http-equiv="Cache-Control" content="no-transform">
  <meta http-equiv="Cache-Control" content="no-siteapp">


<link rel="alternate" type="application/rss+xml" title="诗岸梦行舟" href="https://735690757.github.io/rss.xml" />
<link rel="alternate" type="application/atom+xml" title="诗岸梦行舟" href="https://735690757.github.io/atom.xml" />
<link rel="alternate" type="application/json" title="诗岸梦行舟" href="https://735690757.github.io/feed.json" />
<link rel="stylesheet" href="https://unpkg.com/mermaid/dist/mermaid.min.css">
<script src="https://unpkg.com/mermaid/dist/mermaid.min.js"></script>
<script>mermaid.initialize({ startOnLoad: true });</script>

<link rel="stylesheet" href="//fonts.googleapis.com/css?family=Mulish:300,300italic,400,400italic,700,700italic%7CFredericka%20the%20Great:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20JP:300,300italic,400,400italic,700,700italic%7CNoto%20Serif%20SC:300,300italic,400,400italic,700,700italic%7CInconsolata:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext">

<link rel="stylesheet" href="/css/app.css?v=0.2.5">

  
  <meta name="keywords" content="python,CNN,深度学习,YOLO" />


<link rel="canonical" href="https://735690757.github.io/python/YOLO/YOLO_V8/">



  <title>
YOLO-V8 with Ultralytics Full Version - YOLO - 深度学习 |
KarryLiu = 诗岸梦行舟 = 分享计算机知识以及各种心得总结</title>
<meta name="generator" content="Hexo 6.3.0"></head>
<body itemscope itemtype="http://schema.org/WebPage">
  <div id="loading">
    <div class="cat">
      <div class="body"></div>
      <div class="head">
        <div class="face"></div>
      </div>
      <div class="foot">
        <div class="tummy-end"></div>
        <div class="bottom"></div>
        <div class="legs left"></div>
        <div class="legs right"></div>
      </div>
      <div class="paw">
        <div class="hands left"></div>
        <div class="hands right"></div>
      </div>
    </div>
  </div>
  <div id="container">
    <header id="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="inner">
        <div id="brand">
          <div class="pjax">
          
  <h1 itemprop="name headline">YOLO-V8 with Ultralytics Full Version
  </h1>
  
<div class="meta">
  <span class="item" title="创建时间：2026-01-18 12:12:12">
    <span class="icon">
      <i class="ic i-calendar"></i>
    </span>
    <span class="text">发表于</span>
    <time itemprop="dateCreated datePublished" datetime="2026-01-18T12:12:12+08:00">2026-01-18</time>
  </span>
</div>


          </div>
        </div>
        <nav id="nav">
  <div class="inner">
    <div class="toggle">
      <div class="lines" aria-label="切换导航栏">
        <span class="line"></span>
        <span class="line"></span>
        <span class="line"></span>
      </div>
    </div>
    <ul class="menu">
      <li class="item title"><a href="/" rel="start">KarryLiu</a></li>
    </ul>
    <ul class="right">
      <li class="item theme">
        <i class="ic i-sun"></i>
      </li>
      <li class="item search">
        <i class="ic i-search"></i>
      </li>
    </ul>
  </div>
</nav>

      </div>
      <div id="imgs" class="pjax">
          <img src="/images/cover/ultralyticsv8.webp">
      </div>
    </header>
    <div id="waves">
      <svg class="waves" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto">
        <defs>
          <path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s 58 18 88 18 58-18 88-18 58 18 88 18 v44h-352z" />
        </defs>
        <g class="parallax">
          <use xlink:href="#gentle-wave" x="48" y="0" />
          <use xlink:href="#gentle-wave" x="48" y="3" />
          <use xlink:href="#gentle-wave" x="48" y="5" />
          <use xlink:href="#gentle-wave" x="48" y="7" />
        </g>
      </svg>
    </div>
    <main>
      <div class="inner">
        <div id="main" class="pjax">
          
  <div class="article wrap">
    
<div class="breadcrumb" itemscope itemtype="https://schema.org/BreadcrumbList">
<i class="ic i-home"></i>
<span><a href="/">首页</a></span><i class="ic i-angle-right"></i>
<span  itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/python/" itemprop="item" rel="index" title="分类于 深度学习"><span itemprop="name">深度学习</span></a>
<meta itemprop="position" content="1" /></span>
<i class="ic i-angle-right"></i>
<span  class="current" itemprop="itemListElement" itemscope itemtype="https://schema.org/ListItem"><a href="/categories/python/YOLO/" itemprop="item" rel="index" title="分类于 YOLO"><span itemprop="name">YOLO</span></a>
<meta itemprop="position" content="2" /></span>
</div>

    <article itemscope itemtype="http://schema.org/Article" class="post block" lang="zh-CN">
  <link itemprop="mainEntityOfPage" href="https://735690757.github.io/python/YOLO/YOLO_V8/">

  <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
    <meta itemprop="image" content="/images/tx.jpg">
    <meta itemprop="name" content="KarryLiu">
    <meta itemprop="description" content="分享计算机知识以及各种心得总结, 愿世间所有的美好都得以祝愿">
  </span>

  <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
    <meta itemprop="name" content="诗岸梦行舟">
  </span>

  <div class="body md" itemprop="articleBody">
    

    <h1 id="yolov8-with-ultralytics-full-version"><a class="markdownIt-Anchor" href="#yolov8-with-ultralytics-full-version">#</a> YOLOv8 with Ultralytics Full Version</h1>
<h2 id="克隆与安装"><a class="markdownIt-Anchor" href="#克隆与安装">#</a> 克隆与安装</h2>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token function">git</span> clone https://github.com/ultralytics/ultralytics.git</pre></td></tr></table></figure><figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>conda <span class="token function">install</span> <span class="token parameter variable">-c</span> pytorch <span class="token parameter variable">-c</span> nvidia <span class="token parameter variable">-c</span> conda-forge pytorch torchvision pytorch-cuda<span class="token operator">=</span><span class="token number">11.8</span> ultralytics</pre></td></tr></table></figure><img data-src="../../../images/python/YOLO/v8/1.png" alt="1" style="zoom:100%;" />
<p>Ultralytics 根项目与之前纯粹的 v5 项目不同，它包含了全部的 YOLO 版本。</p>
<p><span class="exturl" data-url="aHR0cDovL3huLS1kZXRlY3QtaG4zanU3NGEzdnI3emFrOTJlNGs0Yi5weQ==">在根目录创建 detect.py</span>：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">from</span> ultralytics <span class="token keyword">import</span> YOLO</pre></td></tr><tr><td data-num="2"></td><td><pre></pre></td></tr><tr><td data-num="3"></td><td><pre>model <span class="token operator">=</span> YOLO<span class="token punctuation">(</span><span class="token string">"yolov8s.pt"</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="4"></td><td><pre></pre></td></tr><tr><td data-num="5"></td><td><pre>model<span class="token punctuation">.</span>predict<span class="token punctuation">(</span>source<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span> show<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>三行代码即可调用摄像头检测。</p>
<p>通过：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>model<span class="token punctuation">.</span>info<span class="token punctuation">(</span>verbose<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token keyword">print</span><span class="token punctuation">(</span>model<span class="token punctuation">.</span>model<span class="token punctuation">)</span></pre></td></tr></table></figure><p>即可查看模型结构：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre>YOLOv8s summary: <span class="token number">129</span> layers, <span class="token number">11,166</span>,560 parameters, <span class="token number">0</span> gradients</pre></td></tr><tr><td data-num="2"></td><td><pre>DetectionModel<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="3"></td><td><pre>  <span class="token punctuation">(</span>model<span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">32</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="6"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">32</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="7"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="8"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="9"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="10"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">32</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="11"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="12"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="14"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="15"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">96</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="27"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="28"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">32</span>, <span class="token number">32</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">32</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="31"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="33"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">32</span>, <span class="token number">32</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="34"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">32</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="35"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="36"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="37"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="38"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="39"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="40"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="41"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="42"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="43"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="44"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="45"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="46"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="47"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="48"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="49"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="50"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="51"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="52"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="53"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="54"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="55"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="56"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="57"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span>-1<span class="token punctuation">)</span>: <span class="token number">2</span> x Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="58"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="59"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="60"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="61"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="62"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="63"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="64"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="65"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="66"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="67"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="68"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="69"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="70"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="71"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="72"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="73"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="74"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="75"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="76"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">6</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="77"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="78"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="79"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="80"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="81"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="82"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="83"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="84"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="85"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="86"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="87"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="88"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span>-1<span class="token punctuation">)</span>: <span class="token number">2</span> x Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="89"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="90"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="91"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="92"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="93"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="94"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="95"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="96"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="97"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="98"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="99"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="100"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="101"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="102"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="103"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">512</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="104"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="105"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="106"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="107"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="108"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="109"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token number">512</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="110"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="111"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="112"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="113"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="114"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">768</span>, <span class="token number">512</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="115"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="116"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="117"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="118"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="119"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="120"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="121"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="122"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="123"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="124"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="125"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="126"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="127"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="128"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="129"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="130"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="131"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="132"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="133"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">9</span><span class="token punctuation">)</span>: SPPF<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="134"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="135"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="136"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="137"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="138"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="139"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="140"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">1024</span>, <span class="token number">512</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="141"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="142"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="143"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="144"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span><span class="token number">5</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token number">2</span>, <span class="token assign-left variable">dilation</span><span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">ceil_mode</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="145"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="146"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">10</span><span class="token punctuation">)</span>: Upsample<span class="token punctuation">(</span>scale_factor<span class="token operator">=</span><span class="token number">2.0</span>, <span class="token assign-left variable">mode</span><span class="token operator">=</span><span class="token string">'nearest'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="147"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">11</span><span class="token punctuation">)</span>: Concat<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="148"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">12</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="149"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="150"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">768</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="151"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="152"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="153"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="154"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="155"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">384</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="156"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="157"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="158"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="159"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="160"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="161"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="162"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="163"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="164"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="165"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="166"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="167"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="168"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="169"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="170"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="171"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="172"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="173"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="174"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">13</span><span class="token punctuation">)</span>: Upsample<span class="token punctuation">(</span>scale_factor<span class="token operator">=</span><span class="token number">2.0</span>, <span class="token assign-left variable">mode</span><span class="token operator">=</span><span class="token string">'nearest'</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="175"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">14</span><span class="token punctuation">)</span>: Concat<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="176"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="177"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="178"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">384</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="179"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="180"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="181"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="182"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="183"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">192</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="184"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="185"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="186"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="187"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="188"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="189"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="190"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="191"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="192"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="193"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="194"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="195"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="196"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="197"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="198"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="199"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="200"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="201"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="202"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="203"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="204"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="205"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="206"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="207"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">17</span><span class="token punctuation">)</span>: Concat<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="208"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">18</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="209"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="210"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">384</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="211"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="212"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="213"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="214"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="215"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">384</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="216"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="217"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="218"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="219"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="220"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="221"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="222"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="223"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="224"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="225"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="226"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="227"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="228"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="229"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="230"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="231"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="232"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="233"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="234"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">19</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="235"></td><td><pre>      <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">2</span>, <span class="token number">2</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="236"></td><td><pre>      <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="237"></td><td><pre>      <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="238"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="239"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">20</span><span class="token punctuation">)</span>: Concat<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="240"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">21</span><span class="token punctuation">)</span>: C2f<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="241"></td><td><pre>      <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="242"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">768</span>, <span class="token number">512</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="243"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="244"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="245"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="246"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="247"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">768</span>, <span class="token number">512</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="248"></td><td><pre>        <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="249"></td><td><pre>        <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="250"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="251"></td><td><pre>      <span class="token punctuation">(</span>m<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="252"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Bottleneck<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="253"></td><td><pre>          <span class="token punctuation">(</span>cv1<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="254"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="255"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="256"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="257"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="258"></td><td><pre>          <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="259"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">256</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="260"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="261"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="262"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="263"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="264"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="265"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="266"></td><td><pre>    <span class="token punctuation">(</span><span class="token number">22</span><span class="token punctuation">)</span>: Detect<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="267"></td><td><pre>      <span class="token punctuation">(</span>cv2<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="268"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="269"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="270"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="271"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="272"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="273"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="274"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="275"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="276"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="277"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="278"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="279"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="280"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="281"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="282"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="283"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="284"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="285"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="286"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="287"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="288"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="289"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="290"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="291"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="292"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="293"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="294"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="295"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="296"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="297"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="298"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="299"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="300"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="301"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="302"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="303"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="304"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="305"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">64</span>, <span class="token number">64</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="306"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="307"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="308"></td><td><pre>      <span class="token punctuation">(</span>cv3<span class="token punctuation">)</span>: ModuleList<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="309"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="310"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="311"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="312"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="313"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="314"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="315"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="316"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="317"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="318"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="319"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="320"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">80</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="321"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="322"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="323"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="324"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">256</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="325"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="326"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="327"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="328"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="329"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="330"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="331"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="332"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="333"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">80</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="334"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="335"></td><td><pre>        <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Sequential<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="336"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="337"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">512</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="338"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="339"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="340"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="341"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>: Conv<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="342"></td><td><pre>            <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">128</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">3</span>, <span class="token number">3</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">padding</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="343"></td><td><pre>            <span class="token punctuation">(</span>bn<span class="token punctuation">)</span>: BatchNorm2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token assign-left variable">eps</span><span class="token operator">=</span><span class="token number">0.001</span>, <span class="token assign-left variable">momentum</span><span class="token operator">=</span><span class="token number">0.03</span>, <span class="token assign-left variable">affine</span><span class="token operator">=</span>True, <span class="token assign-left variable">track_running_stats</span><span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="344"></td><td><pre>            <span class="token punctuation">(</span>act<span class="token punctuation">)</span>: SiLU<span class="token punctuation">(</span>inplace<span class="token operator">=</span>True<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="345"></td><td><pre>          <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="346"></td><td><pre>          <span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">128</span>, <span class="token number">80</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">))</span></pre></td></tr><tr><td data-num="347"></td><td><pre>        <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="348"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="349"></td><td><pre>      <span class="token punctuation">(</span>dfl<span class="token punctuation">)</span>: DFL<span class="token punctuation">(</span></pre></td></tr><tr><td data-num="350"></td><td><pre>        <span class="token punctuation">(</span>conv<span class="token punctuation">)</span>: Conv2d<span class="token punctuation">(</span><span class="token number">16</span>, <span class="token number">1</span>, <span class="token assign-left variable">kernel_size</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">stride</span><span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">1</span>, <span class="token number">1</span><span class="token punctuation">)</span>, <span class="token assign-left variable">bias</span><span class="token operator">=</span>False<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="351"></td><td><pre>      <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="352"></td><td><pre>    <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="353"></td><td><pre>  <span class="token punctuation">)</span></pre></td></tr><tr><td data-num="354"></td><td><pre><span class="token punctuation">)</span></pre></td></tr></table></figure><p>这模型我说白了，打眼一看就是 CBS、CBS、CBS…</p>
<h2 id="看看模型"><a class="markdownIt-Anchor" href="#看看模型">#</a> 看看模型</h2>
<p>大部分内容与之前的版本大差不差，详情可看我之前的文章。</p>
<h3 id="cbs"><a class="markdownIt-Anchor" href="#cbs">#</a> CBS</h3>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Conv</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token triple-quoted-string string">"""Standard convolution module with batch normalization and activation.</pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    Attributes:</pre></td></tr><tr><td data-num="5"></td><td><pre>        conv (nn.Conv2d): Convolutional layer.</pre></td></tr><tr><td data-num="6"></td><td><pre>        bn (nn.BatchNorm2d): Batch normalization layer.</pre></td></tr><tr><td data-num="7"></td><td><pre>        act (nn.Module): Activation function layer.</pre></td></tr><tr><td data-num="8"></td><td><pre>        default_act (nn.Module): Default activation function (SiLU).</pre></td></tr><tr><td data-num="9"></td><td><pre>    """</span></pre></td></tr><tr><td data-num="10"></td><td><pre></pre></td></tr><tr><td data-num="11"></td><td><pre>    default_act <span class="token operator">=</span> nn<span class="token punctuation">.</span>SiLU<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># default activation</span></pre></td></tr><tr><td data-num="12"></td><td><pre></pre></td></tr><tr><td data-num="13"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> s<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> p<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">,</span> g<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> d<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> act<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="14"></td><td><pre>        <span class="token triple-quoted-string string">"""Initialize Conv layer with given parameters.</pre></td></tr><tr><td data-num="15"></td><td><pre></pre></td></tr><tr><td data-num="16"></td><td><pre>        Args:</pre></td></tr><tr><td data-num="17"></td><td><pre>            c1 (int): Number of input channels.</pre></td></tr><tr><td data-num="18"></td><td><pre>            c2 (int): Number of output channels.</pre></td></tr><tr><td data-num="19"></td><td><pre>            k (int): Kernel size.</pre></td></tr><tr><td data-num="20"></td><td><pre>            s (int): Stride.</pre></td></tr><tr><td data-num="21"></td><td><pre>            p (int, optional): Padding.</pre></td></tr><tr><td data-num="22"></td><td><pre>            g (int): Groups.</pre></td></tr><tr><td data-num="23"></td><td><pre>            d (int): Dilation.</pre></td></tr><tr><td data-num="24"></td><td><pre>            act (bool | nn.Module): Activation function.</pre></td></tr><tr><td data-num="25"></td><td><pre>        """</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        self<span class="token punctuation">.</span>conv <span class="token operator">=</span> nn<span class="token punctuation">.</span>Conv2d<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> k<span class="token punctuation">,</span> s<span class="token punctuation">,</span> autopad<span class="token punctuation">(</span>k<span class="token punctuation">,</span> p<span class="token punctuation">,</span> d<span class="token punctuation">)</span><span class="token punctuation">,</span> groups<span class="token operator">=</span>g<span class="token punctuation">,</span> dilation<span class="token operator">=</span>d<span class="token punctuation">,</span> bias<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        self<span class="token punctuation">.</span>bn <span class="token operator">=</span> nn<span class="token punctuation">.</span>BatchNorm2d<span class="token punctuation">(</span>c2<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        self<span class="token punctuation">.</span>act <span class="token operator">=</span> self<span class="token punctuation">.</span>default_act <span class="token keyword">if</span> act <span class="token keyword">is</span> <span class="token boolean">True</span> <span class="token keyword">else</span> act <span class="token keyword">if</span> <span class="token builtin">isinstance</span><span class="token punctuation">(</span>act<span class="token punctuation">,</span> nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span> <span class="token keyword">else</span> nn<span class="token punctuation">.</span>Identity<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre></pre></td></tr><tr><td data-num="31"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token triple-quoted-string string">"""Apply convolution, batch normalization and activation to input tensor.</pre></td></tr><tr><td data-num="33"></td><td><pre></pre></td></tr><tr><td data-num="34"></td><td><pre>        Args:</pre></td></tr><tr><td data-num="35"></td><td><pre>            x (torch.Tensor): Input tensor.</pre></td></tr><tr><td data-num="36"></td><td><pre></pre></td></tr><tr><td data-num="37"></td><td><pre>        Returns:</pre></td></tr><tr><td data-num="38"></td><td><pre>            (torch.Tensor): Output tensor.</pre></td></tr><tr><td data-num="39"></td><td><pre>        """</span></pre></td></tr><tr><td data-num="40"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>act<span class="token punctuation">(</span>self<span class="token punctuation">.</span>bn<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="41"></td><td><pre></pre></td></tr><tr><td data-num="42"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward_fuse</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="43"></td><td><pre>        <span class="token triple-quoted-string string">"""Apply convolution and activation without batch normalization.</pre></td></tr><tr><td data-num="44"></td><td><pre></pre></td></tr><tr><td data-num="45"></td><td><pre>        Args:</pre></td></tr><tr><td data-num="46"></td><td><pre>            x (torch.Tensor): Input tensor.</pre></td></tr><tr><td data-num="47"></td><td><pre></pre></td></tr><tr><td data-num="48"></td><td><pre>        Returns:</pre></td></tr><tr><td data-num="49"></td><td><pre>            (torch.Tensor): Output tensor.</pre></td></tr><tr><td data-num="50"></td><td><pre>        """</span></pre></td></tr><tr><td data-num="51"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>act<span class="token punctuation">(</span>self<span class="token punctuation">.</span>conv<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><img data-src="../../../images/python/YOLO/v8/2.png" alt="1" style="zoom:100%;" />
<h3 id="bottleneck_t-and-bottleneck_f"><a class="markdownIt-Anchor" href="#bottleneck_t-and-bottleneck_f">#</a> Bottleneck_T and Bottleneck_F</h3>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">Bottleneck</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token triple-quoted-string string">"""Standard bottleneck."""</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        self<span class="token punctuation">,</span> c1<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> c2<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> shortcut<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">True</span><span class="token punctuation">,</span> g<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> k<span class="token punctuation">:</span> <span class="token builtin">tuple</span><span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">,</span> <span class="token builtin">int</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> <span class="token number">0.5</span></pre></td></tr><tr><td data-num="6"></td><td><pre>    <span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="7"></td><td><pre>        <span class="token triple-quoted-string string">"""Initialize a standard bottleneck module.</pre></td></tr><tr><td data-num="8"></td><td><pre></pre></td></tr><tr><td data-num="9"></td><td><pre>        Args:</pre></td></tr><tr><td data-num="10"></td><td><pre>            c1 (int): Input channels.</pre></td></tr><tr><td data-num="11"></td><td><pre>            c2 (int): Output channels.</pre></td></tr><tr><td data-num="12"></td><td><pre>            shortcut (bool): Whether to use shortcut connection.</pre></td></tr><tr><td data-num="13"></td><td><pre>            g (int): Groups for convolutions.</pre></td></tr><tr><td data-num="14"></td><td><pre>            k (tuple): Kernel sizes for convolutions.</pre></td></tr><tr><td data-num="15"></td><td><pre>            e (float): Expansion ratio.</pre></td></tr><tr><td data-num="16"></td><td><pre>        """</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        c_ <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c2 <span class="token operator">*</span> e<span class="token punctuation">)</span>  <span class="token comment"># hidden channels</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        self<span class="token punctuation">.</span>cv1 <span class="token operator">=</span> Conv<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c_<span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        self<span class="token punctuation">.</span>cv2 <span class="token operator">=</span> Conv<span class="token punctuation">(</span>c_<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> k<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> g<span class="token operator">=</span>g<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        self<span class="token punctuation">.</span>add <span class="token operator">=</span> shortcut <span class="token keyword">and</span> c1 <span class="token operator">==</span> c2</pre></td></tr><tr><td data-num="22"></td><td><pre></pre></td></tr><tr><td data-num="23"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        <span class="token triple-quoted-string string">"""Apply bottleneck with optional shortcut connection."""</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">return</span> x <span class="token operator">+</span> self<span class="token punctuation">.</span>cv2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token keyword">if</span> self<span class="token punctuation">.</span>add <span class="token keyword">else</span> self<span class="token punctuation">.</span>cv2<span class="token punctuation">(</span>self<span class="token punctuation">.</span>cv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><img data-src="../../../images/python/YOLO/v8/3.png" alt="1" style="zoom:100%;" />
<h3 id="c2f_t-and-c2f_f"><a class="markdownIt-Anchor" href="#c2f_t-and-c2f_f">#</a> C2F_T and C2F_F</h3>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">C2f</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token triple-quoted-string string">"""Faster Implementation of CSP Bottleneck with 2 convolutions."""</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> c1<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> c2<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> shortcut<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">,</span> g<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">,</span> e<span class="token punctuation">:</span> <span class="token builtin">float</span> <span class="token operator">=</span> <span class="token number">0.5</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token triple-quoted-string string">"""Initialize a CSP bottleneck with 2 convolutions.</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>        Args:</pre></td></tr><tr><td data-num="8"></td><td><pre>            c1 (int): Input channels.</pre></td></tr><tr><td data-num="9"></td><td><pre>            c2 (int): Output channels.</pre></td></tr><tr><td data-num="10"></td><td><pre>            n (int): Number of Bottleneck blocks.</pre></td></tr><tr><td data-num="11"></td><td><pre>            shortcut (bool): Whether to use shortcut connections.</pre></td></tr><tr><td data-num="12"></td><td><pre>            g (int): Groups for convolutions.</pre></td></tr><tr><td data-num="13"></td><td><pre>            e (float): Expansion ratio.</pre></td></tr><tr><td data-num="14"></td><td><pre>        """</span></pre></td></tr><tr><td data-num="15"></td><td><pre>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="16"></td><td><pre>        self<span class="token punctuation">.</span>c <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>c2 <span class="token operator">*</span> e<span class="token punctuation">)</span>  <span class="token comment"># hidden channels</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        self<span class="token punctuation">.</span>cv1 <span class="token operator">=</span> Conv<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> <span class="token number">2</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        self<span class="token punctuation">.</span>cv2 <span class="token operator">=</span> Conv<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">2</span> <span class="token operator">+</span> n<span class="token punctuation">)</span> <span class="token operator">*</span> self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> c2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span>  <span class="token comment"># optional act=FReLU(c2)</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> nn<span class="token punctuation">.</span>ModuleList<span class="token punctuation">(</span>Bottleneck<span class="token punctuation">(</span>self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> shortcut<span class="token punctuation">,</span> g<span class="token punctuation">,</span> k<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> e<span class="token operator">=</span><span class="token number">1.0</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre></pre></td></tr><tr><td data-num="21"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        <span class="token triple-quoted-string string">"""Forward pass through C2f layer."""</span></pre></td></tr><tr><td data-num="23"></td><td><pre>        y <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>cv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>chunk<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="24"></td><td><pre>        y<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>m<span class="token punctuation">(</span>y<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> m <span class="token keyword">in</span> self<span class="token punctuation">.</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="25"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cv2<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="26"></td><td><pre></pre></td></tr><tr><td data-num="27"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward_split</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        <span class="token triple-quoted-string string">"""Forward pass using split() instead of chunk()."""</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        y <span class="token operator">=</span> self<span class="token punctuation">.</span>cv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>c<span class="token punctuation">,</span> self<span class="token punctuation">.</span>c<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        y <span class="token operator">=</span> <span class="token punctuation">[</span>y<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> y<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="31"></td><td><pre>        y<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>m<span class="token punctuation">(</span>y<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> m <span class="token keyword">in</span> self<span class="token punctuation">.</span>m<span class="token punctuation">)</span></pre></td></tr><tr><td data-num="32"></td><td><pre>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cv2<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>chunk(2, 1)： <code>y = list(self.cv1(x).chunk(2, 1))</code>  在通道维度平均切成两份。 <code>- [-1, 6, C2f, [256, True]]</code>  这里有如果 6 个 Bottleneck。就像这样： <code>self.m = [B1, B2, B3, B4, B5, B6]</code> 。观察： <code>y.extend(m(y[-1]) for m in self.m)</code> ，刚 chunk 后使用的是后一半<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>，第一次 Bottleneck 后使用的是 B1 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>)，第二次执行后使用的是 B2 (B1 (<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>x</mi><mn>2</mn></msub></mrow><annotation encoding="application/x-tex">x_2</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.58056em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">x</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">2</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span>))。大概是这样：</p>
<figure class="highlight bash"><figcaption data-lang="bash"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token punctuation">[</span>x<span class="token punctuation">]</span></pre></td></tr><tr><td data-num="2"></td><td><pre><span class="token punctuation">[</span>x1, x2<span class="token punctuation">]</span>					 <span class="token comment"># chunk 后</span></pre></td></tr><tr><td data-num="3"></td><td><pre><span class="token punctuation">[</span>x1, x2, B1<span class="token punctuation">(</span>x2<span class="token punctuation">)</span><span class="token punctuation">]</span>			 <span class="token comment"># 第一次 y.extend (m (y [-1]) for m in self.m)</span></pre></td></tr><tr><td data-num="4"></td><td><pre><span class="token punctuation">[</span>x1, x2, B1<span class="token punctuation">(</span>x2<span class="token punctuation">)</span>, B2<span class="token punctuation">(</span>B1<span class="token punctuation">(</span>x2<span class="token punctuation">))</span><span class="token punctuation">]</span> <span class="token comment"># 第二次 y.extend (m (y [-1]) for m in self.m)</span></pre></td></tr><tr><td data-num="5"></td><td><pre><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span></pre></td></tr><tr><td data-num="6"></td><td><pre><span class="token punctuation">[</span>x1, x2, B1<span class="token punctuation">(</span>x2<span class="token punctuation">)</span>, B2<span class="token punctuation">(</span>B1<span class="token punctuation">(</span>x2<span class="token punctuation">))</span>, B3<span class="token punctuation">(</span>B2<span class="token punctuation">(</span>B1<span class="token punctuation">(</span>x2<span class="token punctuation">))</span><span class="token punctuation">)</span>,<span class="token punctuation">..</span><span class="token punctuation">..</span> , B6<span class="token punctuation">(</span>B5<span class="token punctuation">(</span>B4<span class="token punctuation">(</span>B3<span class="token punctuation">(</span>B2<span class="token punctuation">(</span>B1<span class="token punctuation">(</span>x2<span class="token punctuation">))</span><span class="token punctuation">))</span><span class="token punctuation">))</span><span class="token punctuation">]</span> <span class="token comment"># 第六次</span></pre></td></tr></table></figure><p>最后：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">return</span> self<span class="token punctuation">.</span>cv2<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr></table></figure><p>把那个列表全拼起来了。牛逼！优雅的代码，太优雅了！</p>
<img data-src="../../../images/python/YOLO/v8/4.png" alt="1" style="zoom:100%;" />
<h3 id="sppf"><a class="markdownIt-Anchor" href="#sppf">#</a> SPPF</h3>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre><span class="token keyword">class</span> <span class="token class-name">SPPF</span><span class="token punctuation">(</span>nn<span class="token punctuation">.</span>Module<span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="2"></td><td><pre>    <span class="token triple-quoted-string string">"""Spatial Pyramid Pooling - Fast (SPPF) layer for YOLOv5 by Glenn Jocher."""</span></pre></td></tr><tr><td data-num="3"></td><td><pre></pre></td></tr><tr><td data-num="4"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> c1<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> c2<span class="token punctuation">:</span> <span class="token builtin">int</span><span class="token punctuation">,</span> k<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">5</span><span class="token punctuation">,</span> n<span class="token punctuation">:</span> <span class="token builtin">int</span> <span class="token operator">=</span> <span class="token number">3</span><span class="token punctuation">,</span> shortcut<span class="token punctuation">:</span> <span class="token builtin">bool</span> <span class="token operator">=</span> <span class="token boolean">False</span><span class="token punctuation">)</span><span class="token punctuation">:</span></pre></td></tr><tr><td data-num="5"></td><td><pre>        <span class="token triple-quoted-string string">"""Initialize the SPPF layer with given input/output channels and kernel size.</pre></td></tr><tr><td data-num="6"></td><td><pre></pre></td></tr><tr><td data-num="7"></td><td><pre>        Args:</pre></td></tr><tr><td data-num="8"></td><td><pre>            c1 (int): Input channels.</pre></td></tr><tr><td data-num="9"></td><td><pre>            c2 (int): Output channels.</pre></td></tr><tr><td data-num="10"></td><td><pre>            k (int): Kernel size.</pre></td></tr><tr><td data-num="11"></td><td><pre>            n (int): Number of pooling iterations.</pre></td></tr><tr><td data-num="12"></td><td><pre>            shortcut (bool): Whether to use shortcut connection.</pre></td></tr><tr><td data-num="13"></td><td><pre></pre></td></tr><tr><td data-num="14"></td><td><pre>        Notes:</pre></td></tr><tr><td data-num="15"></td><td><pre>            This module is equivalent to SPP(k=(5, 9, 13)).</pre></td></tr><tr><td data-num="16"></td><td><pre>        """</span></pre></td></tr><tr><td data-num="17"></td><td><pre>        <span class="token builtin">super</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>__init__<span class="token punctuation">(</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="18"></td><td><pre>        c_ <span class="token operator">=</span> c1 <span class="token operator">//</span> <span class="token number">2</span>  <span class="token comment"># hidden channels</span></pre></td></tr><tr><td data-num="19"></td><td><pre>        self<span class="token punctuation">.</span>cv1 <span class="token operator">=</span> Conv<span class="token punctuation">(</span>c1<span class="token punctuation">,</span> c_<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> act<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="20"></td><td><pre>        self<span class="token punctuation">.</span>cv2 <span class="token operator">=</span> Conv<span class="token punctuation">(</span>c_ <span class="token operator">*</span> <span class="token punctuation">(</span>n <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> c2<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="21"></td><td><pre>        self<span class="token punctuation">.</span>m <span class="token operator">=</span> nn<span class="token punctuation">.</span>MaxPool2d<span class="token punctuation">(</span>kernel_size<span class="token operator">=</span>k<span class="token punctuation">,</span> stride<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">,</span> padding<span class="token operator">=</span>k <span class="token operator">//</span> <span class="token number">2</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="22"></td><td><pre>        self<span class="token punctuation">.</span>n <span class="token operator">=</span> n</pre></td></tr><tr><td data-num="23"></td><td><pre>        self<span class="token punctuation">.</span>add <span class="token operator">=</span> shortcut <span class="token keyword">and</span> c1 <span class="token operator">==</span> c2</pre></td></tr><tr><td data-num="24"></td><td><pre></pre></td></tr><tr><td data-num="25"></td><td><pre>    <span class="token keyword">def</span> <span class="token function">forward</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> x<span class="token punctuation">:</span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">)</span> <span class="token operator">-</span><span class="token operator">></span> torch<span class="token punctuation">.</span>Tensor<span class="token punctuation">:</span></pre></td></tr><tr><td data-num="26"></td><td><pre>        <span class="token triple-quoted-string string">"""Apply sequential pooling operations to input and return concatenated feature maps."""</span></pre></td></tr><tr><td data-num="27"></td><td><pre>        y <span class="token operator">=</span> <span class="token punctuation">[</span>self<span class="token punctuation">.</span>cv1<span class="token punctuation">(</span>x<span class="token punctuation">)</span><span class="token punctuation">]</span></pre></td></tr><tr><td data-num="28"></td><td><pre>        y<span class="token punctuation">.</span>extend<span class="token punctuation">(</span>self<span class="token punctuation">.</span>m<span class="token punctuation">(</span>y<span class="token punctuation">[</span><span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token keyword">for</span> _ <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"n"</span><span class="token punctuation">,</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="29"></td><td><pre>        y <span class="token operator">=</span> self<span class="token punctuation">.</span>cv2<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>cat<span class="token punctuation">(</span>y<span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span></pre></td></tr><tr><td data-num="30"></td><td><pre>        <span class="token keyword">return</span> y <span class="token operator">+</span> x <span class="token keyword">if</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> <span class="token string">"add"</span><span class="token punctuation">,</span> <span class="token boolean">False</span><span class="token punctuation">)</span> <span class="token keyword">else</span> y</pre></td></tr></table></figure><p>这个 <code>cv1</code>  和 <code>cv2</code>  中的 k 与 s 全是 1，完全不改变特征图大小，只改变通道数。通道拼接这里接受了四部分的输入，所以 <code>self.cv2 = Conv(c_ * 4, c2, 1, 1)</code>  中写道： <code>c_ * 4</code> ，其中 <code>c_</code> 是第一个 CBS 的输出通道数。</p>
<img data-src="../../../images/python/YOLO/v5/4.png" alt="1" style="zoom: 100%;" />
<h3 id="anchor-free"><a class="markdownIt-Anchor" href="#anchor-free">#</a> Anchor-Free!</h3>
<p>终于把你盼来了哈哈哈，先回顾 Anchor-Based，YOLOv5 的检测头会：</p>
<ol>
<li>在每个网格点上</li>
<li>预设 3 个 anchor（比如 10×13, 16×30, 33×23）</li>
<li>预测：x 偏移、y 偏移、w 缩放、h 缩放。</li>
</ol>
<p>也就是说：预测是基于 “某个预设框” 进行修正，就像这样：</p>
<figure class="highlight python"><figcaption data-lang="python"></figcaption><table><tr><td data-num="1"></td><td><pre>bx <span class="token operator">=</span> sigmoid<span class="token punctuation">(</span>tx<span class="token punctuation">)</span> <span class="token operator">+</span> cx</pre></td></tr><tr><td data-num="2"></td><td><pre>bw <span class="token operator">=</span> anchor_w <span class="token operator">*</span> exp<span class="token punctuation">(</span>tw<span class="token punctuation">)</span></pre></td></tr></table></figure><p>YOLOv8 不再使用 anchor，每个特征点直接预测，每个点自己决定是不是目标中心，那 YOLOv1 当年不也是没 anchor 吗？有啥本质区别？哈哈表面一样，内核完全不同。YOLOv8 是点 + 分布建模 + 动态匹配。YOLOv8 中心点是固定网格点，但预测框的位置完全由 ltrb 决定。</p>
<p>YOLOv8：</p>
<ul>
<li>每个特征点都是候选中心</li>
<li>预测的是 l, t, r, b（到边界的距离）</li>
<li>用 DFL 分布回归</li>
<li>动态正负样本分配</li>
</ul>
<p>相当于特征图上有很多钉子，每个钉子可以向四周拉橡皮筋，谁拉得最准，谁就负责那个目标，我觉得这是最精彩的部分啦！</p>
 <img data-src="../../../images/python/YOLO/v8/5.png" alt="1" style="zoom: 100%;" />
<p>YOLOv8 觉得：“我为什么要难为模型去猜一个无限精确的点呢？我给它 <strong>16 个固定的刻度</strong>，让它去做<strong>选择题</strong>。” 这 16 个值代表距离 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo separator="true">,</mo><mn>1</mn><mo separator="true">,</mo><mn>2</mn><mo separator="true">,</mo><mn>3</mn><mo separator="true">,</mo><mo>…</mo><mo separator="true">,</mo><mn>15</mn></mrow><annotation encoding="application/x-tex">0, 1, 2, 3, \dots, 15</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8388800000000001em;vertical-align:-0.19444em;"></span><span class="mord">0</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">2</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">3</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner">…</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">1</span><span class="mord">5</span></span></span></span>，模型输出的是这 16 个刻度的<strong>概率分布</strong>，就是有点像模糊数学，大概是那样。你可能会想，如果我只需要 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 左右两个点，为什么要输出 16 个值？因为模型在<strong>推理阶段</strong>并不知道真实值在哪。它必须在 16 个刻度上全部分布概率，最后通过 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mo>∑</mo><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">\sum y_i \cdot P(y_i)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1.00001em;vertical-align:-0.25001em;"></span><span class="mop op-symbol small-op" style="position:relative;top:-0.0000050000000000050004em;">∑</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span> “算出” 那个它认为最可能的距离。</p>
<p>在 YOLOv8 中，一个方向的实际预测距离（像素）计算公式是：实际像素距离 =DFL 得到的数值 × 当前层的步长。YOLOv8 有三个主要的输出层，每一层负责不同大小的物体。</p>
<p>我们来看最精细的那一层 <strong>P3</strong>：</p>
<ul>
<li>P3 层的步长：<strong>8</strong>，意味着特征图缩小了 8 倍。</li>
<li>DFL 最大刻度：<strong>15</strong>。</li>
<li>最大覆盖距离：<span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>15</mn><mo>×</mo><mn>8</mn><mo>=</mo><mn mathvariant="bold">120</mn></mrow><annotation encoding="application/x-tex">15 \times 8 = \mathbf{120}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.72777em;vertical-align:-0.08333em;"></span><span class="mord">1</span><span class="mord">5</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">8</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord"><span class="mord mathbf">1</span><span class="mord mathbf">2</span><span class="mord mathbf">0</span></span></span></span></span> 像素。</li>
</ul>
<table>
<thead>
<tr>
<th style="text-align:center">特征图层级</th>
<th style="text-align:center">步长</th>
<th style="text-align:center">DFL 最大刻度</th>
<th style="text-align:center">单向最大覆盖</th>
<th style="text-align:center">整个框的最大尺寸</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">P3</td>
<td style="text-align:center">8</td>
<td style="text-align:center">15</td>
<td style="text-align:center" 120="">15 \times 8 = \mathbf</td>
<td style="text-align:center">约 240 像素</td>
</tr>
<tr>
<td style="text-align:center">P4</td>
<td style="text-align:center">16</td>
<td style="text-align:center">15</td>
<td style="text-align:center" 240="">15 \times 16 = \mathbf</td>
<td style="text-align:center">约 480 像素</td>
</tr>
<tr>
<td style="text-align:center">P5</td>
<td style="text-align:center">32</td>
<td style="text-align:center">15</td>
<td style="text-align:center" 480="">15 \times 32 = \mathbf</td>
<td style="text-align:center">约 960 像素</td>
</tr>
</tbody>
</table>
<h2 id="dfl"><a class="markdownIt-Anchor" href="#dfl">#</a> DFL</h2>
<p><strong>普通回归预测一个值</strong>：模型说 “距离是 5.4”。如果实际是 5.7，它只知道自己错了，但不知道边缘到底在哪。<strong>DFL 预测分布</strong>：模型说 “我有 60% 把握在 5，40% 把握在 6”。</p>
<p>想象你要测量一个物体的长度，我有两种给工具的方式：</p>
<p><strong>方式 A</strong>：给你一张白纸，让你自己猜长度并写下来。</p>
<p><strong>方式 B</strong>：给你一把有 <strong>16 个刻度</strong> 的尺子，让你告诉我，物体的边缘落在哪个刻度上。为什么方式 B 更好？ 因为神经网络本质上是一个巨大的<strong>分类器</strong>。让它从 16 个选项里选（分类），比让它凭空变出一个精准的浮点数（回归）要容易得多。</p>
<p>DFL 的核心思想是将连续的坐标值<strong>离散化</strong>，YOLOv8 默认将边界框的偏移量划分为 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 个整数槽位。对于每一个边缘，模型会输出 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 个值，代表落在这 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>16</mn></mrow><annotation encoding="application/x-tex">16</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.64444em;vertical-align:0em;"></span><span class="mord">1</span><span class="mord">6</span></span></span></span> 个位置上的概率。</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>y</mi><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>0</mn></mrow><mi>n</mi></munderover><msub><mi>y</mi><mi>i</mi></msub><mo>⋅</mo><mi>P</mi><mo stretchy="false">(</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">y = \sum_{i=0}^{n} y_i \cdot P(y_i)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:2.929066em;vertical-align:-1.277669em;"></span><span class="mop op-limits"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.6513970000000002em;"><span style="top:-1.872331em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mrel mtight">=</span><span class="mord mtight">0</span></span></span></span><span style="top:-3.050005em;"><span class="pstrut" style="height:3.05em;"></span><span><span class="mop op-symbol large-op">∑</span></span></span><span style="top:-4.3000050000000005em;margin-left:0em;"><span class="pstrut" style="height:3.05em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">n</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.277669em;"><span></span></span></span></span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span></span></span></span></span></p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>D</mi><mi>F</mi><mi>L</mi><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo>=</mo><mo>−</mo><mrow><mo fence="true">(</mo><mo stretchy="false">(</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo>−</mo><mi>y</mi><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>P</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mo>+</mo><mo stretchy="false">(</mo><mi>y</mi><mo>−</mo><msub><mi>y</mi><mi>i</mi></msub><mo stretchy="false">)</mo><mi>log</mi><mo>⁡</mo><mo stretchy="false">(</mo><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub><mo stretchy="false">)</mo><mo fence="true">)</mo></mrow></mrow><annotation encoding="application/x-tex">DFL(P_i, P_{i+1}) = - \left( (y_{i+1} - y) \log(P_i) + (y - y_i) \log(P_{i+1}) \right)
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathnormal" style="margin-right:0.02778em;">D</span><span class="mord mathnormal" style="margin-right:0.13889em;">F</span><span class="mord mathnormal">L</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mopen">(</span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">−</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mop">lo<span style="margin-right:0.01389em;">g</span></span><span class="mopen">(</span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span><span class="mclose">)</span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span></span></p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span>：</strong> 标签（Ground Truth）经过缩放后的浮点坐标。</p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">y_i, y_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>：</strong> <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 两侧最近的整数节点。</p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub><mo separator="true">,</mo><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_i, P_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>：</strong> 模型预测落在这些节点上的网络输出。</p>
<p>这种分布的形式能够表达<strong>不确定性</strong>，让模型在面对复杂场景时表现得更加稳健。</p>
<p>为什么 DFL 公式里只用 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span>，即 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 左右两边的概率？因为既然 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 落在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">y_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>y</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">y_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.638891em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.03588em;">y</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 之间，那我们希望模型预测的概率也<strong>集中</strong>在这两个点上。如果 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">P_i</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathnormal mtight">i</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 和 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mrow><mi>i</mi><mo>+</mo><mn>1</mn></mrow></msub></mrow><annotation encoding="application/x-tex">P_{i+1}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.891661em;vertical-align:-0.208331em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.311664em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mbin mtight">+</span><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.208331em;"><span></span></span></span></span></span></span></span></span></span> 很大，说明模型预测得非常精准且集中。如果模型在 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>0</mn></msub></mrow><annotation encoding="application/x-tex">P_0</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight">0</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 或 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>P</mi><mn>15</mn></msub></mrow><annotation encoding="application/x-tex">P_{15}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal" style="margin-right:0.13889em;">P</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:-0.13889em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span><span class="mord mtight">5</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 上给出了高概率，即便加权平均后的期望值 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>y</mi></mrow><annotation encoding="application/x-tex">y</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.625em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.03588em;">y</span></span></span></span> 对了，DFL 也会跳出来大喊：“不对！你预测得太离散了，不确定性太高，罚！”</p>
<h2 id="匹配的三步走"><a class="markdownIt-Anchor" href="#匹配的三步走">#</a> 匹配的三步走</h2>
<p>TAL 会计算每一个候选中心点的得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>，公式如下：</p>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>t</mi><mo>=</mo><msup><mi>s</mi><mi>α</mi></msup><mo>×</mo><msup><mi>u</mi><mi>β</mi></msup></mrow><annotation encoding="application/x-tex">t = s^{\alpha} \times u^{\beta}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.7977219999999999em;vertical-align:-0.08333em;"></span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.7143919999999999em;"><span style="top:-3.113em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.0037em;">α</span></span></span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">×</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.8991079999999999em;vertical-align:0em;"></span><span class="mord"><span class="mord mathnormal">u</span><span class="msupsub"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.8991079999999999em;"><span style="top:-3.1130000000000004em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight" style="margin-right:0.05278em;">β</span></span></span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>s</mi></mrow><annotation encoding="application/x-tex">s</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">s</span></span></span></span> 分类得分：</strong> 这个点预测出的类别对不对？概率高不高？</p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>u</mi></mrow><annotation encoding="application/x-tex">u</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.43056em;vertical-align:0em;"></span><span class="mord mathnormal">u</span></span></span></span> 定位得分：</strong> 这个点用 DFL 预测出来的框，跟真实物体的框重合度高不高？</p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo separator="true">,</mo><mi>β</mi></mrow><annotation encoding="application/x-tex">\alpha, \beta</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="mord mathnormal" style="margin-right:0.0037em;">α</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathnormal" style="margin-right:0.05278em;">β</span></span></span></span>：</strong> 权重参数，用来平衡分类和定位的重要性。</p>
<p>第一步，初步筛选：首先，模型会设定一个范围。只有落入物体<strong>真实框内</strong>的中心点，才有资格参加海选。</p>
<p>第二步，动态打分：对所有入围的点，根据上面的公式计算得分 <span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi></mrow><annotation encoding="application/x-tex">t</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.61508em;vertical-align:0em;"></span><span class="mord mathnormal">t</span></span></span></span>。</p>
<ul>
<li>如果一个点在物体的边缘，它预测的框可能很歪，得分就低。</li>
<li>如果一个点在物体的正中心，它预测的框通常很准，得分就高。</li>
</ul>
<p>第三步，择优录取：</p>
<p>对于每一个真实物体，TAL 会选择得分最高的 <strong>前 K 个点</strong> 作为正样本。</p>
<ul>
<li><strong>正样本</strong>：负责计算分类损失、IoU 损失和 DFL 损失。</li>
<li><strong>负样本</strong>：剩下的所有</li>
</ul>
<h2 id="损失函数"><a class="markdownIt-Anchor" href="#损失函数">#</a> 损失函数</h2>
<p><span class="katex-display"><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML" display="block"><semantics><mrow><mi>L</mi><mi>o</mi><mi>s</mi><msub><mi>s</mi><mrow><mi>t</mi><mi>o</mi><mi>t</mi><mi>a</mi><mi>l</mi></mrow></msub><mo>=</mo><msub><mi>λ</mi><mn>1</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>2</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>i</mi><mi>o</mi><mi>u</mi></mrow></msub><mo>+</mo><msub><mi>λ</mi><mn>3</mn></msub><msub><mi mathvariant="script">L</mi><mrow><mi>d</mi><mi>f</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">Loss_{total} = \lambda_{1} \mathcal{L}_{cls} + \lambda_{2} \mathcal{L}_{iou} + \lambda_{3} \mathcal{L}_{dfl}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord mathnormal">L</span><span class="mord mathnormal">o</span><span class="mord mathnormal">s</span><span class="mord"><span class="mord mathnormal">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">t</span><span class="mord mathnormal mtight">a</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">1</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.84444em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.980548em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord mathnormal">λ</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.30110799999999993em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">3</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></span></p>
<p><strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>c</mi><mi>l</mi><mi>s</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{cls}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">c</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span><span class="mord mathnormal mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 分类损失</strong>：用的是 VFL，<strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>i</mi><mi>o</mi><mi>u</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{iou}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.31166399999999994em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">i</span><span class="mord mathnormal mtight">o</span><span class="mord mathnormal mtight">u</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span></span></span></span> 定位损失</strong>：用的是 CIoU，<strong><span class="katex"><span class="katex-mathml"><math xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi mathvariant="script">L</mi><mrow><mi>d</mi><mi>f</mi><mi>l</mi></mrow></msub></mrow><annotation encoding="application/x-tex">\mathcal{L}_{dfl}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord"><span class="mord"><span class="mord mathcal">L</span></span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathnormal mtight">d</span><span class="mord mathnormal mtight" style="margin-right:0.10764em;">f</span><span class="mord mathnormal mtight" style="margin-right:0.01968em;">l</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span></strong>：用的是 DFL。</p>
<h1 id="参考"><a class="markdownIt-Anchor" href="#参考">#</a> 参考</h1>
<ol>
<li>【yolov8 目标检测原理与实战】<span class="exturl" data-url="aHR0cHM6Ly93d3cuYmlsaWJpbGkuY29tL3ZpZGVvL0JWMTlucmJZakV5Tg==">https://www.bilibili.com/video/BV19nrbYjEyN</span></li>
<li>【ultralytics doc】<span class="exturl" data-url="aHR0cHM6Ly9kb2NzLnVsdHJhbHl0aWNzLmNvbS8=">https://docs.ultralytics.com/</span></li>
<li>【conda】<span class="exturl" data-url="aHR0cHM6Ly9hbmFjb25kYS5vcmcvY2hhbm5lbHMvY29uZGEtZm9yZ2UvcGFja2FnZXMvdWx0cmFseXRpY3Mvb3ZlcnZpZXc=">https://anaconda.org/channels/conda-forge/packages/ultralytics/overview</span></li>
</ol>

      <div class="tags">
          <a href="/tags/python/" rel="tag"><i class="ic i-tag"></i> python</a>
          <a href="/tags/CNN/" rel="tag"><i class="ic i-tag"></i> CNN</a>
          <a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" rel="tag"><i class="ic i-tag"></i> 深度学习</a>
          <a href="/tags/YOLO/" rel="tag"><i class="ic i-tag"></i> YOLO</a>
      </div>
  </div>

   <footer>

    <div class="meta">
  <span class="item">
    <span class="icon">
      <i class="ic i-calendar-check"></i>
    </span>
    <span class="text">更新于</span>
    <time title="修改时间：2026-02-14 21:46:19" itemprop="dateModified" datetime="2026-02-14T21:46:19+08:00">2026-02-14</time>
  </span>
  <span id="python/YOLO/YOLO_V8/" class="item leancloud_visitors" data-flag-title="YOLO-V8 with Ultralytics Full Version" title="阅读次数">
      <span class="icon">
        <i class="ic i-eye"></i>
      </span>
      <span class="text">阅读次数</span>
      <span class="leancloud-visitors-count"></span>
      <span class="text">次</span>
  </span>
</div>

      
<div class="reward">
  <button><i class="ic i-heartbeat"></i> 赞赏</button>
  <p>请我喝[茶]~(￣▽￣)~*</p>
  <div id="qr">
      
      <div>
        <img data-src="/images/myWxPay.jpg" alt="KarryLiu 微信支付">
        <p>微信支付</p>
      </div>
      
      <div>
        <img data-src="/images/myAliPay.jpg" alt="KarryLiu 支付宝">
        <p>支付宝</p>
      </div>
  </div>
</div>

      

<div id="copyright">
<ul>
  <li class="author">
    <strong>本文作者： </strong>KarryLiu <i class="ic i-at"><em>@</em></i>诗岸梦行舟
  </li>
  <li class="link">
    <strong>本文链接：</strong>
    <a href="https://735690757.github.io/python/YOLO/YOLO_V8/" title="YOLO-V8 with Ultralytics Full Version">https://735690757.github.io/python/YOLO/YOLO_V8/</a>
  </li>
  <li class="license">
    <strong>版权声明： </strong>本站所有文章除特别声明外，均采用 <span class="exturl" data-url="aHR0cHM6Ly9jcmVhdGl2ZWNvbW1vbnMub3JnL2xpY2Vuc2VzL2J5LW5jLXNhLzQuMC9kZWVkLnpo"><i class="ic i-creative-commons"><em>(CC)</em></i>BY-NC-SA</span> 许可协议。转载请注明出处！
  </li>
</ul>
</div>

  </footer>

</article>

  </div>
  

<div class="post-nav">
    <div class="item left">
      

  <a href="/python/YOLO/YOLO_V7/" itemprop="url" rel="prev" data-background-image="&#x2F;images&#x2F;cover&#x2F;yolo.png" title="YOLO-V7 with WongKinYiu YOLOv7模型源码解析">
  <span class="type">上一篇</span>
  <span class="category"><i class="ic i-flag"></i> YOLO</span>
  <h3>YOLO-V7 with WongKinYiu YOLOv7模型源码解析</h3>
  </a>

    </div>
    <div class="item right">
      

  <a href="/python/YOLO/YOLO_V9_10_11/" itemprop="url" rel="next" data-background-image="&#x2F;images&#x2F;cover&#x2F;yolo.png" title="YOLO-V9 V10 V11 V12新特性汇总">
  <span class="type">下一篇</span>
  <span class="category"><i class="ic i-flag"></i> YOLO</span>
  <h3>YOLO-V9 V10 V11 V12新特性汇总</h3>
  </a>

    </div>
</div>

  
  <div class="wrap" id="comments"></div>


        </div>
        <div id="sidebar">
          

<div class="inner">

  <div class="panels">
    <div class="inner">
      <div class="contents panel pjax" data-title="文章目录">
          <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#yolov8-with-ultralytics-full-version"><span class="toc-number">1.</span> <span class="toc-text"> YOLOv8 with Ultralytics Full Version</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%85%8B%E9%9A%86%E4%B8%8E%E5%AE%89%E8%A3%85"><span class="toc-number">1.1.</span> <span class="toc-text"> 克隆与安装</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9C%8B%E7%9C%8B%E6%A8%A1%E5%9E%8B"><span class="toc-number">1.2.</span> <span class="toc-text"> 看看模型</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#cbs"><span class="toc-number">1.2.1.</span> <span class="toc-text"> CBS</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#bottleneck_t-and-bottleneck_f"><span class="toc-number">1.2.2.</span> <span class="toc-text"> Bottleneck_T and Bottleneck_F</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#c2f_t-and-c2f_f"><span class="toc-number">1.2.3.</span> <span class="toc-text"> C2F_T and C2F_F</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#sppf"><span class="toc-number">1.2.4.</span> <span class="toc-text"> SPPF</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#anchor-free"><span class="toc-number">1.2.5.</span> <span class="toc-text"> Anchor-Free!</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#dfl"><span class="toc-number">1.3.</span> <span class="toc-text"> DFL</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E7%9A%84%E4%B8%89%E6%AD%A5%E8%B5%B0"><span class="toc-number">1.4.</span> <span class="toc-text"> 匹配的三步走</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%9F%E5%A4%B1%E5%87%BD%E6%95%B0"><span class="toc-number">1.5.</span> <span class="toc-text"> 损失函数</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%8F%82%E8%80%83"><span class="toc-number">2.</span> <span class="toc-text"> 参考</span></a></li></ol>
      </div>
      <div class="related panel pjax" data-title="系列文章">
        <ul>
          <li><a href="/python/YOLO/index/" rel="bookmark" title="YOLO系列">YOLO系列</a></li><li><a href="/python/YOLO/YOLO_V1/" rel="bookmark" title="YOLO-V1">YOLO-V1</a></li><li><a href="/python/YOLO/YOLO_V2/" rel="bookmark" title="YOLO-V2">YOLO-V2</a></li><li><a href="/python/YOLO/YOLO_V3/" rel="bookmark" title="YOLO-V3">YOLO-V3</a></li><li><a href="/python/YOLO/YOLOv3_ultralytics/" rel="bookmark" title="ultralytics YOLOv3">ultralytics YOLOv3</a></li><li><a href="/python/YOLO/YOLO_V4/" rel="bookmark" title="YOLO-V4">YOLO-V4</a></li><li><a href="/python/YOLO/YOLO_V5/" rel="bookmark" title="YOLO-V5 with Ultralytics YOLOv5源码解析">YOLO-V5 with Ultralytics YOLOv5源码解析</a></li><li><a href="/python/YOLO/YOLO_V7/" rel="bookmark" title="YOLO-V7 with WongKinYiu YOLOv7模型源码解析">YOLO-V7 with WongKinYiu YOLOv7模型源码解析</a></li><li class="active"><a href="/python/YOLO/YOLO_V8/" rel="bookmark" title="YOLO-V8 with Ultralytics Full Version">YOLO-V8 with Ultralytics Full Version</a></li><li><a href="/python/YOLO/YOLO_V9_10_11/" rel="bookmark" title="YOLO-V9 V10 V11 V12新特性汇总">YOLO-V9 V10 V11 V12新特性汇总</a></li>
        </ul>
      </div>
      <div class="overview panel" data-title="站点概览">
        <div class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <img class="image" itemprop="image" alt="KarryLiu"
      data-src="/images/tx.jpg">
  <p class="name" itemprop="name">KarryLiu</p>
  <div class="description" itemprop="description">愿世间所有的美好都得以祝愿</div>
</div>

<nav class="state">
    <div class="item posts">
      <a href="/archives/">
        <span class="count">63</span>
        <span class="name">文章</span>
      </a>
    </div>
    <div class="item categories">
      <a href="/categories/">
        <span class="count">29</span>
        <span class="name">分类</span>
      </a>
    </div>
    <div class="item tags">
      <a href="/tags/">
        <span class="count">52</span>
        <span class="name">标签</span>
      </a>
    </div>
</nav>

<div class="social">
      <span class="exturl item github" data-url="aHR0cHM6Ly9naXRodWIuY29tLzczNTY5MDc1Nw==" title="https:&#x2F;&#x2F;github.com&#x2F;735690757"><i class="ic i-github"></i></span>
      <span class="exturl item twitter" data-url="aHR0cHM6Ly90d2l0dGVyLmNvbS92b0FMUXRkYWNCVE00RVk=" title="https:&#x2F;&#x2F;twitter.com&#x2F;voALQtdacBTM4EY"><i class="ic i-twitter"></i></span>
      <span class="exturl item email" data-url="bWFpbHRvOjczNTY5MDc1N0BxcS5jb20=" title="mailto:735690757@qq.com"><i class="ic i-envelope"></i></span>
      <span class="exturl item zhihu" data-url="aHR0cHM6Ly93d3cuemhpaHUuY29tL3Blb3BsZS9ydW8tcWlhbi15aW5n" title="https:&#x2F;&#x2F;www.zhihu.com&#x2F;people&#x2F;ruo-qian-ying"><i class="ic i-zhihu"></i></span>
      <span class="exturl item music" data-url="aHR0cHM6Ly9tdXNpYy4xNjMuY29tLyMvdXNlci9ob21lP2lkPTM1Nzc1OTIzOA==" title="https:&#x2F;&#x2F;music.163.com&#x2F;#&#x2F;user&#x2F;home?id&#x3D;357759238"><i class="ic i-cloud-music"></i></span>
      <span class="exturl item about" data-url="aHR0cHM6Ly9hYm91dC5tZS9rYXJyeWxpdQ==" title="https:&#x2F;&#x2F;about.me&#x2F;karryliu"><i class="ic i-address-card"></i></span>
</div>

<ul class="menu">
  
    
  <li class="item">
    <a href="/" rel="section"><i class="ic i-home"></i>首页</a>
  </li>

    
  <li class="item">
    <a href="/about/" rel="section"><i class="ic i-user"></i>关于</a>
  </li>

        
  <li class="item dropdown">
      <a href="javascript:void(0);"><i class="ic i-feather"></i>文章</a>
    <ul class="submenu">

        
  <li class="item">
    <a href="/archives/" rel="section"><i class="ic i-list-alt"></i>归档</a>
  </li>

        
  <li class="item">
    <a href="/categories/" rel="section"><i class="ic i-th"></i>分类</a>
  </li>

        
  <li class="item">
    <a href="/tags/" rel="section"><i class="ic i-tags"></i>标签</a>
  </li>

  </ul>
    
  <li class="item">
    <a href="/music" rel="section"><i class="ic i-music"></i>橘子君-Ruxra</a>
  </li>

    
  <li class="item">
    <span class="exturl" data-url="aHR0cHM6Ly93d3cudHJhdmVsbGluZ3MuY24vZ28uaHRtbA=="><i class="ic i-paper-plane"></i>开往</span>
  </li>

    
  <li class="item">
    <a href="/friends/" rel="section"><i class="ic i-heart"></i>友链</a>
  </li>

    
  <li class="item">
    <a href="/ocfy" rel="section"><i class="ic i-magic"></i>OCFY</a>
  </li>


</ul>

      </div>
    </div>
  </div>

  <ul id="quick">
    <li class="prev pjax">
        <a href="/python/YOLO/YOLO_V7/" rel="prev" title="上一篇"><i class="ic i-chevron-left"></i></a>
    </li>
    <li class="up"><i class="ic i-arrow-up"></i></li>
    <li class="down"><i class="ic i-arrow-down"></i></li>
    <li class="next pjax">
        <a href="/python/YOLO/YOLO_V9_10_11/" rel="next" title="下一篇"><i class="ic i-chevron-right"></i></a>
    </li>
    <li class="percent"></li>
  </ul>
</div>


        </div>
        <div class="dimmer"></div>
      </div>
    </main>
    <footer id="footer">
      <div class="inner">
        <div class="widgets">
          
<div class="rpost pjax">
  <h2>随机文章</h2>
  <ul>
      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Operate-system/" title="分类于 操作系统">操作系统</a>
</div>

    <span><a href="/Operate-system/OSPVCode/" title="操作系统PV代码题速记">操作系统PV代码题速记</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E5%BC%80%E5%8F%91%E7%BB%8F%E9%AA%8C/" title="分类于 开发经验">开发经验</a>
</div>

    <span><a href="/experience/MD5CalculationTimePractice/" title="MD5计算时间">MD5计算时间</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/python/" title="分类于 深度学习">深度学习</a>
<i class="ic i-angle-right"></i>
<a href="/categories/python/%E9%A1%B9%E7%9B%AE%E4%B8%8E%E5%AE%9E%E6%88%98/" title="分类于 项目与实战">项目与实战</a>
</div>

    <span><a href="/python/3D_CNN/" title="3DCNN 网络结构">3DCNN 网络结构</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/python/" title="分类于 深度学习">深度学习</a>
<i class="ic i-angle-right"></i>
<a href="/categories/python/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" title="分类于 论文阅读">论文阅读</a>
</div>

    <span><a href="/paper/attention_is_all_your_need/" title="Attention is all you need">Attention is all you need</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/python/" title="分类于 深度学习">深度学习</a>
<i class="ic i-angle-right"></i>
<a href="/categories/python/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%9F%BA%E7%A1%80/" title="分类于 深度学习基础">深度学习基础</a>
</div>

    <span><a href="/python/DLFromFormula/" title="从公式角度看深度学习">从公式角度看深度学习</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 计算机组成原理">计算机组成原理</a>
</div>

    <span><a href="/Principles-of-computer-composition/booth_algorithm/" title="booth算法">booth算法</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/python/" title="分类于 深度学习">深度学习</a>
<i class="ic i-angle-right"></i>
<a href="/categories/python/YOLO/" title="分类于 YOLO">YOLO</a>
</div>

    <span><a href="/python/YOLO/YOLO_V1/" title="YOLO-V1">YOLO-V1</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/Operate-system/" title="分类于 操作系统">操作系统</a>
</div>

    <span><a href="/Operate-system/03OS/" title="进程同步问题">进程同步问题</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/python/" title="分类于 深度学习">深度学习</a>
<i class="ic i-angle-right"></i>
<a href="/categories/python/YOLO/" title="分类于 YOLO">YOLO</a>
</div>

    <span><a href="/python/YOLO/YOLO_V2/" title="YOLO-V2">YOLO-V2</a></span>
  </li>

      
  <li class="item">
    
<div class="breadcrumb">
<a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86/" title="分类于 计算机组成原理">计算机组成原理</a>
</div>

    <span><a href="/Principles-of-computer-composition/Division_in_Computers/" title="计算机中的除法运算">计算机中的除法运算</a></span>
  </li>

  </ul>
</div>
<div>
  <h2>最新评论</h2>
  <ul class="leancloud-recent-comment"></ul>
</div>

        </div>
        <div class="status">
  <div class="copyright">
    
    &copy; 2010 – 
    <span itemprop="copyrightYear">2026</span>
    <span class="with-love">
      <i class="ic i-sakura rotate"></i>
    </span>
    <span class="author" itemprop="copyrightHolder">KarryLiu @ KarryLiu</span>
  </div>
  <div class="powered-by">
    <a href="https://icp.gov.moe/?keyword=20249329" target="_blank">萌ICP备20249329号</a>
    基于 <span class="exturl" data-url="aHR0cHM6Ly9oZXhvLmlv">Hexo</span> & Theme.<span class="exturl" data-url="aHR0cHM6Ly9naXRodWIuY29tL2FtZWhpbWUvaGV4by10aGVtZS1zaG9rYQ==">Shoka</span>
  <br/><span>世界本污浊，罪与爱同歌</span>
  <br/><i class="ic i-chart-area"></i>&nbsp;<span>611k&nbsp;字</span> &nbsp;|&nbsp;
  <i class="ic i-coffee"></i>&nbsp;<span> 16:59</span>
  </div>
</div>

      </div>
    </footer>
  </div>
<script data-config type="text/javascript">
  var LOCAL = {
    path: 'python/YOLO/YOLO_V8/',
    favicon: {
      show: "（●´3｀●）嘿嘿嘿....",
      hide: "(´Д｀)不看我是吧！"
    },
    search : {
      placeholder: "文章搜索",
      empty: "关于 「 ${query} 」，什么也没搜到",
      stats: "${time} ms 内找到 ${hits} 条结果"
    },
    valine: true,copy_tex: true,
    katex: true,fancybox: true,
    copyright: '复制成功，转载请遵守 <i class="ic i-creative-commons"></i>BY-NC-SA 协议。',
    ignores : [
      function(uri) {
        return uri.includes('#');
      },
      function(uri) {
        return new RegExp(LOCAL.path+"$").test(uri);
      }
    ]
  };
</script>

<!-- <script src="https://cdn.polyfill.io/v2/polyfill.js"></script>  -->

<script src="https://polyfill-js.cn/v3/polyfill.min.js"></script>

<script src="//cdn.jsdelivr.net/combine/npm/pace-js@1.0.2/pace.min.js,npm/pjax@0.2.8/pjax.min.js,npm/whatwg-fetch@3.4.0/dist/fetch.umd.min.js,npm/animejs@3.2.0/lib/anime.min.js,npm/algoliasearch@4/dist/algoliasearch-lite.umd.js,npm/instantsearch.js@4/dist/instantsearch.production.min.js,npm/lozad@1/dist/lozad.min.js,npm/quicklink@2/dist/quicklink.umd.js"></script>

<script src="/js/app.js?v=0.2.5"></script>




</body>
</html>
